<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="ProxyApplication1.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:components="clr-namespace:ProxyApplication1.Components"
    BackgroundColor="{DynamicResource PageBackgroundColor}"
    Title="Главная">

    <!-- Корневой слой: BlazorWebView снизу, оверлей поверх -->
    <Grid>

        <!-- Ваше Blazor-приложение -->
        <BlazorWebView x:Name="blazorWebView" HostPage="wwwroot/index.html">
            <BlazorWebView.RootComponents>
                <RootComponent Selector="#app" ComponentType="{x:Type components:Routes}" />
            </BlazorWebView.RootComponents>
        </BlazorWebView>

        <!-- Оверлей с WebView (по умолчанию скрыт) -->
        <!-- Верхняя панель: кнопка слева, «чип» с доменом и IP, копировать -->
        <!-- Оверлей браузера (важно: есть x:Name'ы, которые вы используете в .cs) -->
        <Grid x:Name="BrowserOverlay"
          IsVisible="False"
          BackgroundColor="#EE000000"
          Padding="0"
          InputTransparent="False">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Верхняя панель -->
                <Grid Grid.Row="0"
              BackgroundColor="{DynamicResource PageBackgroundColor}"
              ColumnDefinitions="Auto,*,Auto"
              Padding="10">

                    <!-- Закрыть -->
                    <Button Grid.Column="0"
                  Text="Закрыть"
                  Clicked="OnCloseBrowserClicked"
                  HorizontalOptions="Start" />

                    <!-- «Адресная строка» -->
                    <Border Grid.Column="1"
                  Padding="8,6"
                  BackgroundColor="#3a2bb5"
                  StrokeThickness="0"
                  StrokeShape="RoundRectangle 12"
                  Margin="10,0"
                  HorizontalOptions="Fill"
                  VerticalOptions="Center">
                        <HorizontalStackLayout Spacing="8">
                            <Label x:Name="SecureIcon" Text="🌐" VerticalOptions="Center" />
                            <Label x:Name="HostLabel" FontAttributes="Bold"
                     VerticalOptions="Center" LineBreakMode="TailTruncation" />
                        </HorizontalStackLayout>
                    </Border>

                    <!-- Скопировать IP -->
                    <Button Grid.Column="2"
                  Text="Копировать IP"
                  Clicked="OnCopyIpClicked"
                  VerticalOptions="Center" />
                </Grid>

                <!-- Сам WebView -->
                <WebView x:Name="OverlayWebView" Grid.Row="1" />
            </Grid>
        </Grid>
    </Grid>
</ContentPage>
